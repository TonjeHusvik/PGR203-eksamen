<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Kristiania Survey</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/png" href="../../../images/icon.png" sizes="32x32"/>
</head>
<body onload="checkCookie()">
    <h1>Questionnaire</h1>
    <!--
    <form method="POST" action="/api/setCookie" id="setCookie"> onsubmit="checkCookie()"
        <label>Hi! Whats your name?<br><input type="text" id="cookieName" name="cookieName" placeholder="Enter your first name" /></label>
        <button type="submit">OK</button>
    </form>-->

    <div id="questions">
        <form method="POST" action="/api/newAnswer">

        </form>
    </div>
    
    <div>
        <a href="newQuestion.html">Add new question</a><br>
        <a href="addOption.html">Add options</a><br>
        <a href="showAnswers.html">Show all answers</a><br>
        <a href="editSurvey.html">Edit survey</a>
    </div>
</body>

<script>
    function setCookie(cookieName, cookieValue, expireDays) {
        const date = new Date();
        date.setTime(date.getTime() + (expireDays * 24 * 60 * 60 * 1000));
        let expires = "expires="+date.toUTCString();
        document.cookie = cookieName + "=" + cookieValue + ";" + expires + ";path=/";
    }

    function getCookie(cookieName) {
        let name = cookieName + "=";
        let ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
            let c = ca[i];
            while (c.charAt(0) == ' ') {
                c = c.substring(1);
            }
            if (c.indexOf(name) == 0) {
                return c.substring(name.length, c.length);
            }
        }
        return "";
    }

    function checkCookie() {
        let user = getCookie("cookiename");
        if (user != "") {
            alert("Welcome again " + user);
        } else {
            user = prompt("Please enter your name:", "");
            if (user != "" && user != null) {
                setCookie("cookiename", user, 365);
            }
        }
    }
    /*const form = document.getElementById('setCookie');
    form.addEventListener('submit', (event) =>{
        //gj√∏re noe greier her med cookies
        var nameValue = document.getElementById("cookieName").value;
        return nameValue;
    });*/

    fetch("/api/question")
    .then(function(response){
        return response.text();
    }).then(function(text){
        document.getElementById("questions").innerHTML = text;
    });

</script>
</html>